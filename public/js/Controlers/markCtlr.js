var app=angular.module("eshuri_App",["ngRoute"]);app.filter("toNormal",function(){return function(t){return Number(t)+Number(2e3)}}).filter("toDistrict",function(){return function(t){if(isNaN(t))return t;switch(t){case"1":t="Eastern-Bugesera";break;case"2":t="Eastern-Gatsibo";break;case"3":t="Eastern-Kayonza";break;case"4":t="Eastern-Kirehe";break;case"5":t="Eastern-Ngoma";break;case"6":t="Eastern-Nyagatare";break;case"7":t="Eastern-Rwamagana";break;case"8":t="Kigali-Gasabo";break;case"9":t="Kigali-Kicukiro";break;case"10":t="Kigali-Nyarugenge";break;case"11":t="Northen-Burera";break;case"12":t="Northen-Gakenke";break;case"13":t="Northen-Gicumbi";break;case"14":t="Northen-Musanze";break;case"15":t="Northen-Rulindo";break;case"16":t="Southern-Gisagara";break;case"17":t="Southern-Huye";break;case"18":t="Southern-Kamonyi";break;case"19":t="Southern-Muhanga";break;case"20":t="Southern-Nyamagabe";break;case"21":t="Southern-Nyanza";break;case"22":t="Southern-Nyaruguru";break;case"23":t="Southern-Ruhango";break;case"24":t="Western-Karongi";break;case"25":t="Western-Ngororero";break;case"26":t="Western-Nyabihu";break;case"27":t="Western-Nyamasheke";break;case"28":t="Western-Rubavu";break;case"29":t="Western-Rusizi";break;case"30":t="Western-Rutsiro";break;default:t="_____________________"}return t}}).filter("toTermName",function(){return function(t){return"S"==t?"Semester":"Term"}}).controller("reportCtrl",["$scope","$http","$window",function(t,a,e){t.studentMark=[],t.qTest=0,t.qExam=0,t.qtotal=0,t.testT1=0,t.ExamT1=0,t.totalT1=0,t.testT2=0,t.ExamT2=0,t.totalT2=0,t.testT3=0,t.ExamT3=0,t.totalT3=0,t.yQuotaTotal=0,t.mQuotaTotal=0,t.getAcademicYearsList=function(){a.get("/class.academic_years/"+t.selectClass).then(function(a){t.academic_years=a.data})["catch"](function(t){Notifier.danger(t.data)})},t.showDivs=function(){t.students_list=!0,t.students_report=!1},t.printDiv=function(t){var a=document.head.outerHTML,e=document.getElementById(t).outerHTML,r="location=yes, statusbar=no, menubar=no, titlebar=no, toolbar=no,dependent=no, width=865, height=600, resizable=yes, screenX=200, screenY=200, personalbar=no, scrollbars=yes",o=window.open("","_blank",r),s=o.document;s.open(),s.write("<!doctype html><html>"+a+'<body onLoad="window.print()" class="center">'+e+"</body></html>"),s.close(),o.focus()},t.getClassList=function(){a.get("/classe.list/"+t.school_id).then(function(a){t.ClassList=a.data})["catch"](function(t){Notifier.danger(t.data)})},t.getClassStudents=function(){a.post("/school.students.list",{class_id:t.selectClass}).then(function(a){t.students=a.data})["catch"](function(t){Notifier.danger(t.data)})},t.getAllStudentsReport=function(){t.students_list=!0,t.studentsMark=[],a.post("/report.all",{academic_year:t.choosen_year,class_id:t.selectClass}).then(function(a){var e=a.data[0].term1,r=a.data[0].term2,o=a.data[0].term3;t.classInfo=a.data[0].class_info,t.courses=a.data[0].courses;for(var s=0;s<e.length;s++)for(var n=0;n<r.length;n++)for(var u=0;u<o.length;u++)if(e[s].urn==r[n].urn&&r[n].urn==o[u].urn){var l=100*Number(e[s].total_mark)/Number(e[s].total_quota),m=100*Number(r[n].total_mark)/Number(e[s].total_quota),c=100*Number(o[u].total_mark)/Number(e[s].total_quota),i=(l+m+c)/3,_=Number(e[s].total_mark)+Number(r[n].total_mark)+Number(o[u].total_mark);t.studentsMark.push({name:e[s].name,urn:e[s].urn,test_t1_mark:e[s].test_mark,exam_t1_mark:e[s].exam_mark,total_t1_mark:e[s].total_mark,total_t1_pct:l,test_t2_mark:r[n].test_mark,exam_t2_mark:r[n].exam_mark,total_t2_mark:r[n].total_mark,total_t2_pct:m,test_t3_mark:o[u].test_mark,exam_t3_mark:o[u].exam_mark,total_t3_mark:o[u].total_mark,total_t3_pct:c,annual_pct:i,annual:_})}})},t.getOneStudentReport=function(e){t.students_report=!0,t.students_list=!1,t.studentMark=[],t.qTest=0,t.qExam=0,t.qtotal=0,t.testT1=0,t.ExamT1=0,t.totalT1=0,t.testT2=0,t.ExamT2=0,t.totalT2=0,t.testT3=0,t.ExamT3=0,t.totalT3=0,t.yQuotaTotal=0,t.mQuotaTotal=0,a.post("/report.one",{academic_year:t.choosen_year,class_id:t.selectClass,student_id:e,school_id:t.school_id}).then(function(a){var e=a.data[0].term1,r=a.data[0].term2,o=a.data[0].term3;t.userInfo=a.data[0].userInfo;for(var s=0;s<e.length;s++)for(var n=0;n<r.length;n++)for(var u=0;u<o.length;u++)if(e[s].name==r[n].name&&r[n].name==o[u].name){var l=Number(e[s].course_q)+Number(r[n].course_q)+Number(o[u].course_q),m=Number(e[s].total)+Number(r[n].total)+Number(o[u].total),c=100*m/l;t.studentMark.push({name:e[s].name,test_quota:e[s].test_q,exam_quota:e[s].exam_q,course_quota:e[s].course_q,testTerm1:e[s].test,examTerm1:e[s].exam,totalTerm1:e[s].total,testTerm2:r[n].test,examTerm2:r[n].exam,totalTerm2:r[n].total,testTerm3:o[u].test,examTerm3:o[u].exam,totalTerm3:o[u].total,anualQuotaTotal:l,anualMarkTotal:m,anualMarkPct:c}),t.qTest+=e[s].test_q,t.qExam+=e[s].exam_q,t.qtotal+=e[s].course_q,t.testT1+=e[s].test,t.ExamT1+=e[s].exam,t.totalT1+=e[s].total,t.testT2+=r[n].test,t.ExamT2+=r[n].exam,t.totalT2+=r[n].total,t.testT3+=o[u].test,t.ExamT3+=o[u].exam,t.totalT3+=o[u].total,t.yQuotaTotal+=l,t.mQuotaTotal+=m}t.totalT1Pct=100*t.totalT1/t.qtotal,t.totalT2Pct=100*t.totalT2/t.qtotal,t.totalT3Pct=100*t.totalT3/t.qtotal,t.anualTotalT3Pct=100*t.mQuotaTotal/t.yQuotaTotal})["catch"](function(t){Notifier.danger(t.data)})},t.districts=["Eastern-Bugesera","Eastern-Gatsibo","Eastern-Kayonza","Eastern-Kirehe","Eastern-Ngoma","Eastern-Nyagatare","Eastern-Rwamagana","Kigali-Gasabo","Kigali-Kicukiro","Kigali-Nyarugenge","Northen-Burera","Northen-Gakenke","Northen-Gicumbi","Northen-Musanze","Northen-Rulindo","Northen-Nyabihu","Southern-Gisagara","Southern-Huye","Southern-Kamonyi","Southern-Muhanga","Southern-Nyamagabe","Southern-Nyanza","Southern-Nyaruguru","Southern-Ruhango","Western-Karongi","Western-Ngororero","Western-Nyabihu","Western-Nyamasheke","Western-Rubavu","Western-Rusizi","Western-Rutsiro"],t.school_id="#{school_id}",t.school_name="#{school_name}",t.school_district="#{school_district}",t.term_name="#{term_name}",t.students_report=!1,t.getClassList()}]);